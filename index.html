<!DOCTYPE html>
<html>
  <head>
    <title>P&C Paradigm</title>
    <script src="jsPsych/jspsych.js"></script>
    <script src="jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jsPsych/plugins/jspsych-image-keyboard-response.js"></script>
    <script src="jsPsych/plugins/jspsych-fullscreen.js"></script>
    <script src="jsPsych/plugins/jspsych-instructions.js"></script>
    <script src="jsPsych/plugins/jspsych-survey-multi-choice.js"></script>
    <link href="jsPsych/css/jspsych.css" rel="stylesheet" type="text/css">
  </head>
  <body></body>
  <script>

///last changes made by Jordan on 4/13
///////////////////////////////////////////////////////
/* create timeline */

var tl = []; //timeline initialized empty

/////////////////////////////////////////////////////
/* define the welcome & consent information */
var welcome = {
  type: "html-keyboard-response",
  stimulus: "Welcome to our experiment! Please turn off any music or television, and put your phone on silent" +
  "<p>Press any key to begin.</p>"
};
tl.push(welcome);

var consent = {
  type: "html-keyboard-response",
  stimulus: "Info here"
};
tl.push(consent);

tl.push({
  type: 'fullscreen',
  message: '<div class="instructions"><p>Thank you for agreeing to participate.</p><p>Press the button below to begin in full screen mode.</p></div>',
  fullscreen_mode: true
});

/////////////////////////////////////////////////////
/* define the SCENARIOS */
var scenario_stimuli1 = ["Just a few weeks ago, I was going to the grocery store. I saw an elderly dog lying on its side and asked a clerk how long it had been lying there. It had been lying there all day."];
var scenario_stimuli2 = ["My daughter and I were shopping in a toy store at the mall. We found a wallet that had money and receipts in it."];
var scenario_stimuli3 = ["The day after I married my ex-husband, his previous girlfriend came to our house and dropped of their three-month-old son. We didn’t see her again for eleven years and I became wife and mom. The child was extremely undernourished and has ADHD."];
var scenario_stimuli4 = ["A few years ago my mom fell. She hurt herself badly."];
var scenario_stimuli5 = ["Three years ago I had a call from a friend of mine who was overseas. His nephew was coming over to the States to go to medical school near me."];
var scenario_stimuli6 = ["I was on the beach one day and saw a small dolphin roll up on the beach. I alerted the lifeguard and he said that it happened all the time and it would just die."];
var scenario_stimuli7 = ["I was friends with a woman who wanted to pursue her acting career. She was going to pawn this ring that was in her family for years. I didn’t want her to pawn the ring."];
var scenario_stimuli8 = ["I had a bad relationship with my father and had not talked to him for years. He had left my mother. When my mother died."];
var scenario_stimuli9 = ["My friends and I were going skiing over the Christmas holiday. On our way up we were in a car accident and a small child in another car was killed. I felt so sorry for the mother."];
var scenario_stimuli10 = ["I was at an office party and the company had decorated a room for a fancy dinner. At the end of the night my friend said that we could take the candles that were on the table. She didn’t know that we weren’t supposed to take the candles"];
var scenario_stimuli11 = ["After my father became a widower I would try to do things for him. He would ask if I was doing okay"];
var scenario_stimuli12 = ["A few years ago, my baby was very ill. I had just brought home my newborn baby and with my cat, my baby was becoming progressively sicker. I really didn’t want to, but for the sake of my baby’s health,"];

/* define the OPTIONS */
var option_stimuli1 = jsPsych.randomization.sampleWithoutReplacement([
  { option: "Keep walking",  type: 'Ordinary',  correct_response: 'f'},
  { option: "Rescue the dog and bring it home with you",   type: 'Saintly', correct_response: 'f'},
  { option: "Turn back time, so that the dog was young again",   type: 'Impossible', correct_response: 'j'}
]);

/* Adding all the scenarios to an array, we will loop through this array*/
/* TODO: Add in the remaining scenarios once the list is finalized*/
var scenarios = [scenario_stimuli1,scenario_stimuli2];

/* define the OPTIONS */
/* TODO: Add the remaining options once the list is finalized*/
var options1 = jsPsych.randomization.shuffle([
      { option: "Get it some water",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Look around for the owner",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Pet the dog",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Give the dog a treat",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Look for the dog's name tag",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Bring the dog home with you",   type: 'Saintly', correct_response: 'f'},
      { option: "Give the dog a dog bed",   type: 'Saintly', correct_response: 'f'},
      { option: "Start a search for the owner",   type: 'Saintly', correct_response: 'f'},
      { option: "Hang lost dog photos all over",   type: 'Saintly', correct_response: 'f'},
      { option: "Pay for a vet appointment",   type: 'Saintly', correct_response: 'f'},
      { option: "Turn back time to the dog's younger days",   type: 'Impossible', correct_response: 'j'},
      { option: "Clone the dog",   type: 'Impossible', correct_response: 'j'},
      { option: "Give the dog eternal life",   type: 'Impossible', correct_response: 'j'},
      { option: "Instruct the dog in mindfulness meditation",   type: 'Impossible', correct_response: 'j'},
      { option: "Teach the dog to talk",   type: 'Impossible', correct_response: 'j'}])

var options2 = jsPsych.randomization.shuffle([
      { option: "Tell a worker about the wallet",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Look around for the owner",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Look through the receipts",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Look for the drivers license",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Figure out the wallet's brand",  type: 'Ordinary',  correct_response: 'f'},
      { option: "Drive to the owner's house ",   type: 'Saintly', correct_response: 'f'},
      { option: "Search each store in the mall",   type: 'Saintly', correct_response: 'f'},
      { option: "Put $1000 into the wallet",   type: 'Saintly', correct_response: 'f'},
      { option: "Start making overhead announcements",   type: 'Saintly', correct_response: 'f'},
      { option: "Ask all passersby",   type: 'Saintly', correct_response: 'f'},
      { option: "Use telekinsesis to return the wallet",   type: 'Impossible', correct_response: 'j'},
      { option: "Use their &quot;sixth sense&quot;",   type: 'Impossible', correct_response: 'j'},
      { option: "Give the wallet sentience",   type: 'Impossible', correct_response: 'j'},
      { option: "Travel back in time",   type: 'Impossible', correct_response: 'j'},
      { option: "Gain dog-like sniffing abilities",   type: 'Impossible', correct_response: 'j'}])

/* Add all options-arrays to yet another array */
/* By doing this we have an ordered array containing all the scenarios, as well as an array containing all the options ordered like the scenarios*/
/* TODO add in all the remaining options */
var options = [options1, options2]

/* Creating a list of shuffled numbers, we will use this list to ensure scenarios and options are randomized in the same way*/
/* Essentially, we will randomize this list and access our scenarios & options through this list */
/* Note that this list should have the same length as the "scenarios" variable*/
var shuffledList = jsPsych.randomization.shuffle([0,1])
console.log('shuffledList: '+shuffledList)

/////////////////////////////////////////////////////
/* define instruction information */

var gen_instructions = {
  type: "html-keyboard-response",
  stimulus: "You will now begin the experiment.</p>" + 
      "<p>We'd like you to tell us whether different actions are possible or impossible responses to scenarios you will read about.</p>" +
      "<p>You will have to make many of these decisions under time pressure.</p>" +
      "<p>To indicate that it is true that something is possible, press the [f] key; to indicate that it is false that something is NOT possible, please press the [j] key.</p>" +
      "<p> To get you used to the task, you will first go through a warm-up phase.</p>" + 
      "<p>On these trials, press [f] if you see the word <b>true</b> and [j] if you see the word <b>false</b>.</p>" +
      "<p><b>***You will have to respond very quickly, so please pay attention!***</b></p>" + 
      "<p>Press any key to begin.</p>",
  post_trial_gap: 1000
};
var task_instructions = {
  type: "html-keyboard-response",
  stimulus: "Great! In this part, you will read a scenario and then will be judging whether different actions are possible or impossible."+
  "<p>***Please answer as quickly and accurately as you possibly can. You will only have about <b>1 second</b> to respond to each event.***</p>"};
var read_instructions = {
  type: "html-keyboard-response",
  stimulus: "Please read the following scenario. The scenario will be displayed for 5 seconds."};
var scen_instructions = {
  type: "html-keyboard-response",
  stimulus: "Given the scenario you just read, please tell us whether it is possible or impossible to do the following actions." +
  "<p> Press the SPACE BAR when you are ready to begin.</p>" +
  "<p>*** Remember, this will go very quickly!***</p>",
  choices: " "
};
var interim_block = {
  type: "html-keyboard-response",
  stimulus: "Great! You have completed a trial." +
  "<p> Press the SPACE BAR to begin the next trial.</p>",
  choices: " "
};
/////////////////////////////////////////////////////
/* define the procedure parts */

var scenario1 = {
  type: "html-keyboard-response",
  stimulus: scenario_stimuli1,
  choices: jsPsych.NO_KEYS,
  trial_duration: 5000,
};

var test1 = {
  type: "html-keyboard-response",
  stimulus: jsPsych.timelineVariable('option'),
  choices: ['f', 'j'],
  data: {
    test_part: 'response',
    correct_response: jsPsych.timelineVariable('correct_response')
  }
}

/////////////////////////////////////////////////////
/* define survey information */
// havent added any individual diff measures yet

var DSR1q = ["Strongly disagree", "Mildly disagree", "Neither agree nor disagree", "Mildly agree", "Strongly agree"];
var Genderq = ["Male", "Female", "Non-binary", "Other"];
var PolIDq = ["Extremely Liberal", " ", " ", " Neither", " ", " ", "Extremely Conservative"];
var Relq = ["Not at all Religious", " ", " ", " ", " ", " ", "Extremely Religious"];
var Incomeq = ["Less than $10,000 USD a year", "$10,000 - $20,000 USD", "$20,000-$40,000 USD", "$40,000-$60,000 USD", "$60,000-$80,000 USD", "$80,000-$100,000 USD", "$100,000 USD a year or more"];
var Raceq = ["White, not hispanic or latinx", "Black or African American", "Asian", "American Indian or Alaska Native", "Native Hawaiian or Other Pacific Islander", "Hispanic or Latinx", "Two or more", "Not listed"];
var Demand1q = ["Not at all", " ", " ", " ", "Very much so"];
var compTypeq = ["Laptop/Desktop", "Ipad/Tablet", "Other"];

  var DSR_b1 = {
            type: 'survey-multi-choice',
            questions: [
                {prompt: '<p style="text-align: left;font-size:20px;">A persons family is the most important thing in life.</p>', options: DSR1q, required: true, horizontal: true,}, 
                {prompt: '<p style="text-align: left;font-size:20px;">It would bother me to be in a science class, and to see a human hand preserved in a jar.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">It bothers me to hear someone clear a throat full of mucous.</p>', options: DSR1q, required: true, horizontal: true,}, 
                {prompt: '<p style="text-align: left;font-size:20px;">I never let any part of my body touch the toilet seat in public restrooms.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">I would go out of my way to avoid walking through a graveyard.</p>', options: DSR1q, required: true, horizontal: true,}, 
                {prompt: '<p style="text-align: left;font-size:20px;">Seeing a cockroach in someone elses house doesnt bother me.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">It would bother me tremendously to touch a dead body.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">If I see someone vomit, it makes me sick to my stomach.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">I probably would not go to my favorite restaurant if I found out that the cook had a cold.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">It would not upset me at all to watch a person with a glass eye take the eye out of the socket.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">It would bother me to see a rat run across my path in a park.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">I would rather eat a piece of fruit than a piece of paper.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">Even if I was hungry, I would not drink a bowl of my favorite soup if it had been stirred by a used but thoroughly washed flyswatter.</p>', options: DSR1q, required: true, horizontal: true},
                {prompt: '<p style="text-align: left;font-size:20px;">It would bother me to sleep in a nice hotel room if I knew that a man had died of a heart attack in that room the night before.</p>', options: DSR1q, required: true, horizontal: true}
            ],
            randomize_question_order: true,
            preamble: 'Please indicate how much you agree with each of the following statements, or how true it is about you. Please write a number (0-4) to indicate your answer:'
            };

  var demo_Age = {
        type: 'survey-text',
        questions: [
        {prompt: 'How old are you?', columns: 3, required: true, name: 'Age'},
        {prompt: 'What is your religious affiliation?', columns: 50, name: 'Religious Affiliation'}
        ],
        randomize_question_order: true
        };

  var demo_gen = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">What is your Gender?</p>', options: Genderq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">What is your Race?</p>', options: Raceq, required: true, horizontal: true},
            {prompt: '<p style="text-align: left;font-size:20px;">How religious would you consider yourself?</p>', options: Relq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">What is your household income?</p>', options: Incomeq, required: true, horizontal: true}
          ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"Using the scales provided, please respond to each question about you as an individual.</p>'
        };

  var demo_PolIQ = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">Which response best captures your political beliefs surrounding economic issues?</p>', options: PolIDq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Which response best captures your political beliefs surrounding social issues?</p>', options: PolIDq, required: true, horizontal: true},
            {prompt: '<p style="text-align: left;font-size:20px;">When it comes to overall political issues, you consider yourself to be a:</p>', options: PolIDq, required: true, horizontal: true,}
        ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"Please answer the following questions about your political ideology.</p>'
        };

  var demo_FinalQs = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">What kind of device did you use to complete this study?</p>', options: compTypeq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Did you feel pressure to respond in a particular way to any of the questions?</p>', options: Demand1q, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Did you feel as though you might be judged for your responses to the questions you answered.</p>', options: Demand1q, required: true, horizontal: true}        
          ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"For these final questions, please answer as honestly as you can! The answers to these questions will not affect whether or not you receive credit/payment for participation!</p>'
        };


////////////////////////////////////////////////////////////////
/* define the procedure & order */
tl.push(instructions);
tl.push(task_instructions);

tl.push(fixation);
tl.push(read_instructions)
/* Looping through all the scenarios */
    /* Because we are indexing scenarios through shuffled list, the order is randomized */
    for (var i = 0; i < shuffledList.length; i++){
            /* Show a random scenario */
            var display_scenarios = {
                type: "html-keyboard-response",
                stimulus: scenarios[shuffledList[i]], //jsPsych.timelineVariable("stimulus"),
                choices: jsPsych.NO_KEYS,
                trial_duration: 5000
            }
            tl.push(display_scenarios);

            /*Display the scenario instructions*/
            tl.push(scen_instructions)
            
            /*Looping through the options */
            /* Because we are indexing the options through shuffled list, the correct options per scenario are displayed */
            
            for (var j = 0; j < options[i].length; j++){
                var display_options = {
                    type: 'html-keyboard-response',
                    prompt: "<p style='text-align:bottom'>Press f for impossible, press j for possible.</p>",
                    choices: ['f','j'],
                    post_trial_gap: 1000,
                    stimulus: options[shuffledList[i]][j].option,
                    data: {test_part: 'response', correct_response: jsPsych.timelineVariable('correct_response')}
                };
                tl.push(display_options)
            }
            /* We probably want to display something in between scenarios to "reset" the block, we can put that here */
            tl.push(interim_block)
        };

tl.push(DSR_b1);
tl.push(demo_Age);
tl.push(demo_gen);
tl.push(demo_PolIQ);
tl.push(demo_FinalQs);

////////////////////////////////////////////////////////////////
///* define debrief */

var debrief = {
      type: "html-keyboard-response",
      stimulus: "<p>Thank you for your participation!</p>" + 
      "<p>Some things.",
      post_trial_gap: 2000
    };
    tl.push(debrief);

////////////////////////////////////////////////////////////////
/* start the experiment */
jsPsych.init({
  timeline: tl
});
</script>
</html>
